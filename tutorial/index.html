
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ubc-provenance.github.io/PIDSMaker/tutorial/">
      
      
        <link rel="prev" href="../pipeline/">
      
      
        <link rel="next" href="../config/featurization/">
      
      
      <link rel="icon" href="../assets/ninja_small.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Implement a new PIDS - PIDSMaker Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PIDSMaker Documentation" class="md-header__button md-logo" aria-label="PIDSMaker Documentation" data-md-component="logo">
      
  <img src="../assets/ninja_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PIDSMaker Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implement a new PIDS
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ubc-provenance/PIDSMaker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PIDSMaker Documentation" class="md-nav__button md-logo" aria-label="PIDSMaker Documentation" data-md-component="logo">
      
  <img src="../assets/ninja_small.png" alt="logo">

    </a>
    PIDSMaker Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ubc-provenance/PIDSMaker" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ten-minute-install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../singularity_install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apptainer installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-db-from-scratch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install a dataset from scratch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Implement a new PIDS
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Implement a new PIDS
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-a-new-encoder" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate a new encoder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-a-new-system" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate a new system
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Run the pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analyze-results" class="md-nav__link">
    <span class="md-ellipsis">
      Analyze results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Try variants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Arguments
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Arguments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/featurization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Featurization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/encoders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/decoders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decoders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hyperparameter Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/batching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batching & Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/instability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instability Measurement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../release_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-a-new-encoder" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate a new encoder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-a-new-system" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate a new system
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Run the pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analyze-results" class="md-nav__link">
    <span class="md-ellipsis">
      Analyze results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Try variants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Implement a new PIDS</h1>

<p>In this tutorial, we craft a brand new architecture using existing components in the framework and evaluate it on node-level intrusion detection.</p>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<p>Our goal is to implement a new system that satisfies the following requirements:</p>
<ul>
<li>Compute text embeddings from the textual attributes of entities, such as file paths, process commands, and socket IP addresses.</li>
<li>Learn behavior-specific representations for both source and destination nodes.</li>
<li>Leverage GraphSAGE layers to capture structural patterns within the provenance graph.</li>
<li>Use the node embeddings generated by the encoder as input to a two-layer MLP decoder, training the model in a self-supervised manner to predict edge types—following an approach similar to that of the Kairos and Orthrus systems.</li>
<li>In the final step, classify nodes as malicious if their predicted score exceeds a threshold, defined as the maximum loss observed on the validation set.</li>
</ul>
<p><a class="glightbox" href="../img/archi.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Architecture" src="../img/archi.jpg" /></a></p>
<p><strong>Approach</strong>: We will craft a new encoder and intgrate it in the framework in such a way that it can be used from arguments. We will then create a YML config describing our system's pipeline and will execute it.</p>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<ul>
<li>a GPU (min 5 GB memory required), or a CPU</li>
<li>RAM &gt;20GB</li>
<li>storage &gt;10GB</li>
<li>follow the <a data-preview="data-preview" href="../ten-minute-install/">installation guidelines</a> and have a shell opened in the pids container</li>
</ul>
<h2 id="integrate-a-new-encoder">Integrate a new encoder<a class="headerlink" href="#integrate-a-new-encoder" title="Permanent link">&para;</a></h2>
<p>In this example, we implement a new encoder that captures whether nodes are source or destination, then uses a GraphSAGE model to capture structural patterns in the provenance graph.</p>
<div class="highlight"><span class="filename">encoders/custom_encoder.py</span><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pidsmaker.encoders</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAGE</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CustomEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">hid_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">graph_reindexer</span><span class="p">,</span> <span class="n">activation</span><span class="p">,</span> <span class="n">dropout</span><span class="p">,</span> <span class="n">num_layers</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">src_proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">hid_dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dst_proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">hid_dim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sage</span> <span class="o">=</span> <span class="n">SAGE</span><span class="p">(</span>
            <span class="n">in_dim</span><span class="o">=</span><span class="n">hid_dim</span><span class="p">,</span>
            <span class="n">hid_dim</span><span class="o">=</span><span class="n">hid_dim</span><span class="p">,</span>
            <span class="n">out_dim</span><span class="o">=</span><span class="n">out_dim</span><span class="p">,</span>
            <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
            <span class="n">num_layers</span><span class="o">=</span><span class="n">num_layers</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph_reindexer</span> <span class="o">=</span> <span class="n">graph_reindexer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_src</span><span class="p">,</span> <span class="n">x_dst</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Project source and destination nodes in a separate embedding space</span>
        <span class="n">h_src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">src_proj</span><span class="p">(</span><span class="n">x_src</span><span class="p">)</span>  <span class="c1"># (E, d)</span>
        <span class="n">h_dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dst_proj</span><span class="p">(</span><span class="n">x_dst</span><span class="p">)</span>  <span class="c1"># (E, d)</span>

        <span class="c1"># Reshape features to (N, d)</span>
        <span class="n">h_src_N</span><span class="p">,</span> <span class="n">h_dst_N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_reindexer</span><span class="o">.</span><span class="n">node_features_reshape</span><span class="p">(</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">h_src</span><span class="p">,</span> <span class="n">h_dst</span><span class="p">,</span> <span class="n">x_is_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h_src_N</span> <span class="o">+</span> <span class="n">h_dst_N</span>  <span class="c1"># (N, d)</span>

        <span class="c1"># Pass them through a SAGE GNN</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sage</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">)</span>
</code></pre></div>
<p>In this example, only two arguments are specific to the encoder and are not shared globally across all encoders: the <code>activation</code> function and the number of GNN layers (<code>num_layers</code>). We want to allow users to specify these parameters via the configuration file to facilitate experimentation with different values.
To achieve this, we need to define a new set of arguments tailored specifically for this encoder.</p>
<div class="highlight"><span class="filename">config/config.py</span><pre><span></span><code><span class="n">ENCODERS_CFG</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;custom_encoder&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s2">&quot;num_layers&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an encoder doesn't rely on any custom arguments, simply leave the dict empty: <code>"custom_encoder": {}</code>, but every encoder should be defined here, or it will not be recognized by the framework.</p>
</div>
<p>All logic related to component instantiation is located in <code>factory.py</code>. To integrate our new encoder, we will add a new case in the <code>encoder_factory()</code> function. The existing <code>graph_reindexer</code> instance can be reused. Here, <code>custom_encoder</code> refers to the name of the encoder, which we will later specify in the configuration file.</p>
<div class="highlight"><span class="filename">factory.py: encoder_factory()</span><pre><span></span><code>    <span class="o">...</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;custom_encoder&quot;</span><span class="p">:</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">CustomEncoder</span><span class="p">(</span>
            <span class="n">in_dim</span><span class="o">=</span><span class="n">in_dim</span><span class="p">,</span>
            <span class="n">hid_dim</span><span class="o">=</span><span class="n">node_hid_dim</span><span class="p">,</span>
            <span class="n">out_dim</span><span class="o">=</span><span class="n">node_out_dim</span><span class="p">,</span>
            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
            <span class="n">graph_reindexer</span><span class="o">=</span><span class="n">graph_reindexer</span><span class="p">,</span>
<span class="hll">            <span class="n">activation</span><span class="o">=</span><span class="n">activation_fn_factory</span><span class="p">(</span>
</span><span class="hll">                <span class="n">cfg</span><span class="o">.</span><span class="n">detection</span><span class="o">.</span><span class="n">gnn_training</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">custom_encoder</span><span class="o">.</span><span class="n">activation</span><span class="p">),</span>
</span><span class="hll">            <span class="n">num_layers</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">detection</span><span class="o">.</span><span class="n">gnn_training</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">custom_encoder</span><span class="o">.</span><span class="n">num_layers</span><span class="p">,</span>
</span>            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
<p>Our new argument <code>activation</code> can be accessed from the <code>cfg</code> object via <code>cfg.detection.gnn_training.encoder.custom_encoder.activation</code>.</p>
<p>Then add the encoder to the list of available encoders in <code>__init__.py</code>.</p>
<div class="highlight"><span class="filename">encoders/__init__.py</span><pre><span></span><code><span class="o">...</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.custom_encoder</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomEncoder</span>
</code></pre></div>
<h2 id="integrate-a-new-system">Integrate a new system<a class="headerlink" href="#integrate-a-new-system" title="Permanent link">&para;</a></h2>
<p>To integrate a new system, first create a new YAML file: <code>config/custom_system.yml</code>. This file describes all the logic of our new PIDS pipeline.
In this example, we take <code>orthrus</code> as base configuration. We only override some arguments for simplicity.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>All available arguments for each component and task can be found in the pages under the <strong>Configuration</strong> section of the documentation.</p>
</div>
<p><strong>Config:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">config/custom_system.yml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">_include_yml</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orthrus</span><span class="w"> </span><span class="c1"># (1)!</span>

<span class="nt">preprocessing</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build_graphs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">time_window_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15.0</span><span class="w"> </span><span class="c1"># (2)!</span>
<span class="w">    </span><span class="nt">node_label_features</span><span class="p">:</span><span class="w"> </span><span class="c1"># (14)!</span>
<span class="w">      </span><span class="nt">subject</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type, path, cmd_line</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type, path</span>
<span class="w">      </span><span class="nt">netflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type, remote_ip, remote_port</span>

<span class="nt">featurization</span><span class="p">:</span>
<span class="w">  </span><span class="nt">feat_training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">emb_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">    </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="nt">used_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word2vec</span><span class="w"> </span><span class="c1"># (15)!</span>
<span class="w">    </span><span class="nt">word2vec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">alpha</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.025</span>
<span class="w">      </span><span class="nt">window_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">min_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">use_skip_gram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">      </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">compute_loss</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">      </span><span class="nt">negative</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">decline_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>

<span class="nt">detection</span><span class="p">:</span>
<span class="w">  </span><span class="nt">graph_preprocessing</span><span class="p">:</span>
<span class="w">    </span><span class="nt">node_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node_emb,node_type</span><span class="w"> </span><span class="c1"># (16)!</span>
<span class="w">    </span><span class="nt">edge_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"> </span><span class="c1"># (17)!</span>
<span class="w">    </span><span class="nt">intra_graph_batching</span><span class="p">:</span>
<span class="w">      </span><span class="nt">used_methods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"> </span><span class="c1"># (3)!</span>

<span class="w">  </span><span class="nt">gnn_training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span><span class="w"> </span><span class="c1"># (4)!</span>
<span class="w">    </span><span class="nt">node_hid_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">    </span><span class="nt">node_out_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>

<span class="w">    </span><span class="nt">encoder</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dropout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.3</span>
<span class="w">      </span><span class="nt">used_methods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom_encoder</span><span class="w"> </span><span class="c1"># (5)!</span>
<span class="w">      </span><span class="nt">custom_encoder</span><span class="p">:</span>
<span class="w">        </span><span class="nt">activation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">relu</span><span class="w"> </span><span class="c1"># (6)!</span>
<span class="w">        </span><span class="nt">num_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>

<span class="w">    </span><span class="nt">decoder</span><span class="p">:</span>
<span class="w">      </span><span class="nt">used_methods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">predict_edge_type</span><span class="w"> </span><span class="c1"># (7)!</span>
<span class="w">      </span><span class="nt">predict_edge_type</span><span class="p">:</span>
<span class="w">        </span><span class="nt">decoder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge_mlp</span><span class="w"> </span><span class="c1"># (8)!</span>
<span class="w">        </span><span class="nt">edge_mlp</span><span class="p">:</span>
<span class="w">          </span><span class="nt">src_dst_projection_coef</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"> </span><span class="c1"># (9)!</span>
<span class="w">          </span><span class="nt">architecture_str</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linear(0.5) | relu</span><span class="w"> </span><span class="c1"># (10)!</span>

<span class="w">  </span><span class="nt">evaluation</span><span class="p">:</span>
<span class="w">    </span><span class="nt">used_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node_evaluation</span><span class="w"> </span><span class="c1"># (11)!</span>
<span class="w">    </span><span class="nt">node_evaluation</span><span class="p">:</span>
<span class="w">      </span><span class="nt">threshold_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">max_val_loss</span><span class="w"> </span><span class="c1"># (12)!</span>
<span class="w">      </span><span class="nt">use_kmeans</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"> </span><span class="c1"># (13)!</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>In this example, we take the <code>orthrus</code> system as base configuration.</li>
<li>We partition the graphs in time windows of size 15 minutes.</li>
<li>By default <code>orthrus</code> partitions each time window in even smaller batches of 1024 edges. To discard this behavior, we set <code>used_methods: None</code>.</li>
<li>We set some custom hyperparameters for training.</li>
<li>It's here that we tell the encoder to use, in this case our new <code>custom_encoder</code>.</li>
<li>We set the values for our two defined arguments: <code>activation</code> and <code>num_layers</code>.</li>
<li>Our objective is to predict edge types as recent research shows it it the best approach yet.</li>
<li>Here, <code>edge_mlp</code> is a MLP designed for edge-level tasks like edge type prediction. It first projects src and dst nodes with different linear layers, then applies the MLP specified in <code>architecture_str</code>.</li>
<li>This arg refers to how many times the size of the input should be the output of the src/dst linear layer. Here we want to project to an embedding with double the input size.</li>
<li>Our final neural network prior to prediction is a two-layer MLP including relu activation. An additional linear layer is added after the relu to match the output size expected by the objective, here the number of edge types.</li>
<li>Refers to node-level detection.</li>
<li>We compute the threshold based on the maximum loss seen on the validation set.</li>
<li>We use here a simple thresholding, without clustering.</li>
<li>We describe here the features assigned to each type of entity.</li>
<li>We train a word2vec model and embed each node's features (<code>node_label_features</code>) into a vector of size <code>emb_dim</code>.</li>
<li>The features to use as node features during GNN training. Here we concatenate the word2vec embedding and one-hot encoded entity type.</li>
<li>Our model doesn't integrate edge features so we do not use any in this example.</li>
</ol>
<h2 id="run-the-pipeline">Run the pipeline<a class="headerlink" href="#run-the-pipeline" title="Permanent link">&para;</a></h2>
<p>In the pids container, you can now run the pipeline. We highly recommend using VSCode with the dev container extension to open your whole workspace in the container to avoid re-building the image after updating the code. Using dev container also enables to run the framework in debug mode using VSCode's debugger.</p>
<p>For tiny experiments, you can run the framework locally like so:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>scripts
python<span class="w"> </span>pidsmaker/main.py<span class="w"> </span>custom_system<span class="w"> </span>CADETS_E3<span class="w"> </span>--project<span class="o">=</span>test_custom_system
</code></pre></div>
<p>For more practical experimentation, prefer running the framework in background and monitor the logs, figures and metrics in Weights &amp; Biases (W&amp;B).
To do so, ensure you have logged to W&amp;B with <code>wandb login</code> and run:</p>
<div class="highlight"><pre><span></span><code>./run.sh<span class="w"> </span>custom_system<span class="w"> </span>CADETS_E3<span class="w"> </span>--project<span class="o">=</span>test_custom_system
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code>--cpu</code> to run the framework on CPU instead of GPU.</p>
</div>
<h2 id="analyze-results">Analyze results<a class="headerlink" href="#analyze-results" title="Permanent link">&para;</a></h2>
<p>In the W&amp;B interface, go to the <code>test_custom_system</code> project and you can check real-time logs and metrics being updated to your ongoing run.</p>
<p><a class="glightbox" href="../img/logs.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Logs" src="../img/logs.jpg" /></a></p>
<p>Once finished, we provide some figures to illustrate the ability of the model to differentiate attack and benign nodes.</p>
<p><a class="glightbox" href="../img/red-dots.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Red dots" src="../img/red-dots.jpg" /></a></p>
<p>Results show a noticeable separation between benign and some malicious nodes on all three attacks in the <code>E3-CADETS</code> dataset.
However, the threshold (vertical line) is not adequately located in the space of anomaly scores, leading to 21 TPs and 33 FPs, whereas some nodes can be detected without any FP.</p>
<p>System metrics such as GPU memory, RAM, and CPU utilization are automatically captured by W&amp;B and can be visualized on the interface.</p>
<p><a class="glightbox" href="../img/metrics.jpg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Metrics" src="../img/metrics.jpg" /></a></p>
<h2 id="try-variants">Try variants<a class="headerlink" href="#try-variants" title="Permanent link">&para;</a></h2>
<p>While this first version of the model yields relatively satisfactory results, we have no guarantee it has the best performing set of arguments on this dataset. We can easily experiment with multiple variants using CLI args. Depending on your hardware, you can run multiple runs in parallel even on a single GPU (usually up to 3-4 parallel runs with simple architectures on a A100 GPU without major runtime overhead).</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove node type from node features, keep only the word2vec embedding</span>
./run.sh<span class="w"> </span>custom_system<span class="w"> </span>CADETS_E3<span class="w"> </span>--project<span class="o">=</span>test_custom_system<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--detection.graph_preprocessing.node_features<span class="o">=</span>node_emb

<span class="c1"># Increase node embedding size</span>
./run.sh<span class="w"> </span>custom_system<span class="w"> </span>CADETS_E3<span class="w"> </span>--project<span class="o">=</span>test_custom_system<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--detection.gnn_training.node_hid_dim<span class="o">=</span><span class="m">256</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--detection.gnn_training.node_out_dim<span class="o">=</span><span class="m">256</span>

<span class="c1"># Reduce the number of GNN layers</span>
./run.sh<span class="w"> </span>custom_system<span class="w"> </span>CADETS_E3<span class="w"> </span>--project<span class="o">=</span>test_custom_system<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--detection.gnn_training.encoder.custom_encoder.num_layers<span class="o">=</span><span class="m">2</span>
</code></pre></div>
<p>For more advanced hyperparameter exploration, consider using the <a href="../features/tuning/">hyperparameter tuning feature</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 UBC provenance team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ubc-provenance/PIDSMaker" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["tabs", "content.code.copy", "content.code.annotate", "navigation.instant", "navigation.sections"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>